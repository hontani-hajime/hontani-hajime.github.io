<!DOCTYPE html>
<html>
<head>
  <title>メモアプリ</title>
</head>
<body>
  <h1>メモアプリ</h1>
  <textarea id="memo" placeholder="ここにメモを書く" rows="10" cols="30"></textarea><br>
  <button onclick="saveMemo()">保存</button>

  <h2>保存されたメモ</h2>
  <div id="savedMemo"></div>

  <!-- Firebase SDKの読み込み -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBtqi9l_tX008yxnz2PUe-Q2pUJ2G8w_-8",
      authDomain: "hontani-hajime.firebaseapp.com",
      projectId: "hontani-hajime",
      storageBucket: "hontani-hajime.firebasestorage.app",
      messagingSenderId: "101204510454",
      appId: "1:101204510454:web:8ec5f953baa2101e534ed7",
      measurementId: "G-F1QB1KG7MW"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function saveMemo() {
      const text = document.getElementById("memo").value;
      if (text.trim() === "") {
        alert("メモが空です");
        return;
      }

      await addDoc(collection(db, "memos"), {
        content: text,
        timestamp: new Date()
      });

      alert("メモを保存しました！");
      document.getElementById("memo").value = "";
      loadMemos();
    }

    async function loadMemos() {
      const memosCol = collection(db, "memos");
      const q = query(memosCol, orderBy("timestamp", "desc"));
      const memosSnapshot = await getDocs(q);

      const output = document.getElementById("savedMemo");
      output.innerHTML = "";
      memosSnapshot.forEach((doc) => {
        const data = doc.data();
        const div = document.createElement("div");
        div.textContent = data.content;
        output.appendChild(div);
      });
    }

    // ページ読み込み時にメモを取得
    loadMemos();
  </script>
</body>
</html>
